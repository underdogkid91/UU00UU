define([
  'vendor/dimensions',
  'objects/extruded_svg',
  'materials/UU00UUE3'
], function (
  Dimensions,
  ExtrudedSvgObject,
  PastelsMaterialsKit
) {
  var Letter = ExtrudedSvgObject.extend({
    _properties: {
      svg: '',
      time: 0,
      time_offset: 0
    },

    initialize: function (properties) {
      this.setExtrusionMaterials({
        main: PastelsMaterialsKit.accent,
        front: PastelsMaterialsKit[properties.name],
        back: PastelsMaterialsKit[properties.name]
      });
      Dimensions.Object.prototype.initialize.apply(this, arguments);
      this.set('scale', 0.3);
    },

    addObjects: function () {
      var wrapper = new Dimensions.Object({
        rotation_z: -Math.PI / 32 + Math.random() * Math.PI / 16
      });
      this.addObject('wrapper', wrapper);

      wrapper.addObject('bounding', new Dimensions.SphereObject({
        geometry: [80, 16],
        material: Dimensions.Material.transparent
      }));

      wrapper.getObject('bounding').onMouseEnter = _.bind(this.onMouseEnter, this);
      wrapper.getObject('bounding').onMouseLeave = _.bind(this.onMouseLeave, this);
    },

    _setTime: function (time) {
      this.getObject('wrapper').set('position_y', 20 * Math.sin(time / 500 + Math.PI / 2 + this.get('time_offset')) );
      if (!this.get('hover')) {
        this.set('rotation_y', Math.PI / 8 * Math.cos(time / 2000 + this.get('time_offset')));
      } else {
        this.set('rotation_y', this.get('rotation_y') + 0.2);
      }
    },

    onMouseEnter: function () {
      this.set('hover', true);
      if (this._left) clearTimeout(this._left);
    },

    onMouseLeave: function () {
      var self = this;
      this._left = setTimeout(function () {
        self.set('hover', false);
        self._left = null;
      }, 250);
    }
  });

  // create all letter factories
  var Letters = {};
  _.each([
    { name: 'U', svg: 'M139.6,115.84 C139.6,141.334819 126.870572,154.28 97.8,154.28 C68.7294279,154.28 56,141.334819 56,115.84 L56,57.0094177 C56,50.3715576 61.3712914,45 68.0035568,45 L80.7964432,45 C87.4180275,45 92.8,50.3740365 92.8,57.0019595 L92.8,115.24 C92.8,120.301672 93.0423914,120.6 97.8,120.6 C102.557609,120.6 102.8,120.301672 102.8,115.24 L102.8,57.0019595 C102.8,50.3666132 108.173732,45 114.803557,45 L127.596443,45 C134.22036,45 139.6,50.3797166 139.6,57.0094177 L139.6,115.84 Z' },
    { name: 'N', svg: 'M142.8,141.600749 C142.8,148.223312 137.424898,153.6 130.798027,153.6 L116.801973,153.6 C111.387025,153.6 105.725853,150.104182 103.305786,145.264048 L93.6,126 L93.6,141.606022 C93.6,148.239664 88.2187964,153.6 81.5902344,153.6 L70.0097656,153.6 C63.3691657,153.6 58,148.232686 58,141.600749 L58,57.9992514 C58,51.3766876 63.3751018,46 70.0019727,46 L83.9980273,46 C89.4129755,46 95.074147,49.4958181 97.4942141,54.3359524 L107.2,74 L107.2,57.9939782 C107.2,51.3603362 112.581204,46 119.209766,46 L130.790234,46 C137.430834,46 142.8,51.367314 142.8,57.9992514 L142.8,141.600749 Z' },
    { name: 'D', svg: 'M142.44,102.2 C142.44,138.283056 128.459215,153.6 95,153.6 L70.0044356,153.6 C63.3673119,153.6 58,148.230692 58,141.600749 L58,57.9992514 C58,51.3759163 63.3769769,46 70.0044356,46 L95,46 C128.459215,46 142.44,61.3169441 142.44,97.4 L142.44,102.2 Z', holes: ['M94.871039,119.906794 C103.562275,119.6813 105.28,116.462374 105.28,102.2 L105.28,97.4 C105.28,83.0823505 103.548935,79.8939156 94.7696734,79.690719 L94.871039,119.906794 Z'] },
    { name: 'E', svg: 'M124.799434,46 C131.429212,46 136.8,51.3652409 136.8,57.991536 L136.8,67.688464 C136.8,74.3124981 131.420005,79.68 124.794354,79.68 L100.799999,79.6800003 L100.827456,82 L118.795564,82 C125.430269,82 130.8,87.3634376 130.8,93.991536 L130.8,103.688464 C130.8,110.312118 125.420925,115.68 118.795564,115.68 L100.8,115.684628 L100.831562,119.92 L124.794354,119.92 C131.422861,119.92 136.8,125.284013 136.8,131.911536 L136.8,141.608464 C136.8,148.230904 131.423869,153.6 124.799434,153.6 L76.0005657,153.6 C69.3683687,153.6 64,148.228887 64,141.600749 L64,57.9992514 C64,51.3771283 69.3740302,46 76.0005657,46 L124.799434,46 Z' },
    { name: 'R', svg: 'M96.8,141.592655 C96.8,148.228141 91.4277816,153.6 84.7964432,153.6 L72.0035568,153.6 C65.3828194,153.6 60,148.228028 60,141.600749 L60,57.9992514 C60,51.3746958 65.3799421,46 72.0083324,46 L99.28,46 C110.270469,46 118.812226,47.6246569 125.861148,52.1490814 C135.093758,58.075129 140,68.2319104 140,82.52 L140,84.92 C140,98.0070515 134.95779,108.194257 127.359558,114.260254 L137.590987,139.324351 C140.514619,146.48725 135.727652,153.6 127.992172,153.6 L113.407828,153.6 C107.742417,153.6 102.094245,149.711151 100.078012,144.413597 L96.891446,136.041052 L96.8,141.592655 Z', holes: ['M96.8571645,87.76 L100.24,87.76 C102.70274,87.76 102.96,87.5500759 102.96,84.2 L102.96,83.24 C102.96,79.8899241 102.70274,79.68 100.24,79.68 L96.842593,79.68 L96.8571645,87.76 Z'] },
    { name: 'O', svg: 'M54,101.88 L54,97.08 C54,61.4329682 68.1424079,44 97.84,44 C127.537592,44 141.68,61.4329682 141.68,97.08 L141.68,101.88 C141.68,137.527032 127.537592,154.96 97.84,154.96 C68.1424079,154.96 54,137.527032 54,101.88 Z', holes: ['M98.44,121.28 C100.764339,121.28 101.643703,120.666158 102.57537,118.446172 C103.892722,115.307169 104.52,110.00298 104.52,101.88 L104.52,97.08 C104.52,88.9570203 103.892722,83.6528312 102.57537,80.5138283 C101.643703,78.2938418 100.764339,77.68 98.44,77.68 L97.24,77.68 C94.9156606,77.68 94.0362965,78.2938418 93.10463,80.5138283 C91.787278,83.6528312 91.16,88.9570203 91.16,97.08 L91.16,101.88 C91.16,110.00298 91.787278,115.307169 93.10463,118.446172 C94.0362965,120.666158 94.9156606,121.28 97.24,121.28 L98.44,121.28 Z'] },
    { name: 'G', svg: 'M143.12,136.92 L143.12,140.301122 L140.471605,142.403022 C129.978978,150.730504 118.458336,154.96 102.04,154.96 C71.3248006,154.96 57,137.728718 57,101.88 L57,97.08 C57,61.4329682 71.1424079,44 100.84,44 C128.596957,44 143.24,56.8080751 143.24,84 C143.24,90.4379789 137.745087,95.68 131.236443,95.68 L118.443557,95.68 C113.43616,95.68 109.00035,92.6042409 107.061229,88.207484 C106.521604,86.9839395 106.175326,85.6580948 106.063883,84.2677662 L106.042135,83.802509 C106.039991,83.6428866 106.02078,83.2396235 105.969248,82.686935 C105.883466,81.7669272 105.740645,80.8577224 105.542972,80.075944 C105.395474,79.4925981 105.233373,79.048898 105.104769,78.8137483 C104.644907,77.9729042 104.103105,77.68 102.04,77.68 L100.84,77.68 C97.8767547,77.68 96.8658074,78.3426636 95.95463,80.5138283 C94.6971272,83.5102219 94.16,88.545789 94.16,97.08 L94.16,101.88 C94.16,110.432253 94.7050505,115.406921 95.9914765,118.356995 C96.9447854,120.543155 98.1203102,121.28 101.44,121.28 L102.64,121.28 C105.699207,121.28 106.560839,120.873014 106.325462,120.859236 C100.036131,120.491085 95.04,115.273292 95.04,108.888464 L95.04,99.191536 C95.04,92.571777 100.409626,87.2 107.032023,87.2 L136.12,87.2 L143.12,87.2 L143.12,94.2 L143.12,136.92 Z' },
    { name: 'K', svg: 'M94.8005369,59.7784929 L98.4301128,53.6989532 C101.109149,49.2115681 106.773051,46 111.998152,46 L129.601848,46 C138.022799,46 142.296841,54.199303 137.483832,61.1039471 L116.938801,90.5819948 L138.919542,139.165597 C142.156255,146.319639 137.43401,153.6 129.591161,153.6 L114.408839,153.6 C108.835611,153.6 103.184597,149.868684 100.994799,144.74766 L94.8,130.473914 L94.8,141.603325 C94.8,148.228996 89.4233623,153.6 82.7964432,153.6 L70.0035568,153.6 C63.3828194,153.6 58,148.228028 58,141.600749 L58,57.9992514 C58,51.3761915 63.3763079,46 70.0035568,46 L82.7964432,46 C89.4197122,46 94.8,51.3781391 94.8,58.0073455 L94.8005369,59.7784929 Z' },
    { name: 'I', svg: 'M117.8,141.600749 C117.8,148.223808 112.423692,153.6 105.796443,153.6 L93.0035568,153.6 C86.3828194,153.6 81,148.228028 81,141.600749 L81,57.9992514 C81,51.3761915 86.3763079,46 93.0035568,46 L105.796443,46 C112.417181,46 117.8,51.3719722 117.8,57.9992514 L117.8,141.600749 Z' }
  ], function (letter_def) {
    Letters[letter_def.name] = function(properties) {
      return new Letter(_.extend(properties, {
        name: letter_def.name,
        svg: { main: letter_def.svg, holes: letter_def.holes }
      }));
    };
  });

  return Letters;
});
